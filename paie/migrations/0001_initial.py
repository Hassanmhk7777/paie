# Generated by Django 4.2.7 on 2025-08-07 09:39

import datetime
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AnneePaie',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('annee', models.IntegerField(unique=True, verbose_name='Année')),
                ('date_debut', models.DateField(verbose_name='Date de début')),
                ('date_fin', models.DateField(verbose_name='Date de fin')),
                ('nb_jours_travail_annuel', models.IntegerField(default=260)),
                ('nb_heures_travail_annuel', models.DecimalField(decimal_places=2, default=2288.0, max_digits=8)),
                ('is_active', models.BooleanField(default=True, verbose_name='Active')),
                ('is_closed', models.BooleanField(default=False, verbose_name='Clôturée')),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('cree_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Année de Paie',
                'verbose_name_plural': 'Années de Paie',
                'ordering': ['-annee'],
            },
        ),
        migrations.CreateModel(
            name='Department',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nom du département')),
                ('description', models.TextField(blank=True, null=True, verbose_name='Description')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True, verbose_name='Actif')),
            ],
            options={
                'verbose_name': 'Département',
                'verbose_name_plural': 'Départements',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('first_name', models.CharField(max_length=100, verbose_name='Prénom')),
                ('last_name', models.CharField(max_length=100, verbose_name='Nom')),
                ('email', models.EmailField(max_length=254, unique=True, verbose_name='Email')),
                ('phone', models.CharField(blank=True, max_length=15, null=True, verbose_name='Téléphone')),
                ('position', models.CharField(max_length=100, verbose_name='Poste')),
                ('hire_date', models.DateField(verbose_name="Date d'embauche")),
                ('matricule', models.CharField(blank=True, max_length=20, unique=True, verbose_name='Matricule')),
                ('conges_acquis_debut_annee', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('date_derniere_maj_conges', models.DateField(blank=True, null=True)),
                ('notification_email_conges', models.BooleanField(default=True)),
                ('notification_sms_conges', models.BooleanField(default=False)),
                ('salary', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(0)], verbose_name='Salaire de base')),
                ('numero_cnss', models.CharField(blank=True, max_length=20, verbose_name='N° CNSS')),
                ('numero_amo', models.CharField(blank=True, max_length=20, verbose_name='N° AMO')),
                ('numero_cimr', models.CharField(blank=True, max_length=20, verbose_name='N° CIMR')),
                ('numero_mutuelle', models.CharField(blank=True, max_length=20, verbose_name='N° Mutuelle')),
                ('situation_familiale', models.CharField(choices=[('CELIBATAIRE', 'Célibataire'), ('MARIE', 'Marié(e)'), ('DIVORCE', 'Divorcé(e)'), ('VEUF', 'Veuf(ve)')], default='CELIBATAIRE', max_length=20, verbose_name='Situation familiale')),
                ('nb_enfants_charge', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)], verbose_name="Nombre d'enfants à charge")),
                ('conjoint_salarie', models.BooleanField(default=False, verbose_name='Conjoint salarié')),
                ('regime_horaire', models.CharField(choices=[('TEMPS_PLEIN', 'Temps plein'), ('TEMPS_PARTIEL', 'Temps partiel')], default='TEMPS_PLEIN', max_length=20, verbose_name='Régime horaire')),
                ('nb_heures_semaine', models.DecimalField(decimal_places=2, default=44.0, max_digits=4, verbose_name='Heures par semaine')),
                ('affilie_cimr', models.BooleanField(default=False, verbose_name='Affilié CIMR')),
                ('exonere_ir', models.BooleanField(default=False, verbose_name='Exonéré IR')),
                ('banque_principale', models.CharField(blank=True, max_length=100, verbose_name='Banque')),
                ('rib_principal', models.CharField(blank=True, max_length=30, verbose_name='RIB')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True, verbose_name='Actif')),
                ('department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='paie.department', verbose_name='Département')),
                ('manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employes_geres', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Employé',
                'verbose_name_plural': 'Employés',
                'ordering': ['last_name', 'first_name'],
            },
        ),
        migrations.CreateModel(
            name='ParametragePaie',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('plafond_cnss', models.DecimalField(decimal_places=2, default=6000.0, max_digits=10)),
                ('plafond_frais_prof', models.DecimalField(decimal_places=2, default=2500.0, max_digits=10)),
                ('deduction_personne', models.DecimalField(decimal_places=2, default=30.0, max_digits=6)),
                ('taux_cnss_salarie', models.DecimalField(decimal_places=2, default=4.48, max_digits=5)),
                ('taux_cnss_patronal', models.DecimalField(decimal_places=2, default=6.4, max_digits=5)),
                ('taux_prestations_sociales', models.DecimalField(decimal_places=2, default=8.98, max_digits=5)),
                ('taux_formation_prof', models.DecimalField(decimal_places=2, default=1.6, max_digits=5)),
                ('taux_amo_salarie', models.DecimalField(decimal_places=2, default=2.26, max_digits=5)),
                ('taux_amo_patronal', models.DecimalField(decimal_places=2, default=2.26, max_digits=5)),
                ('taux_participation_amo', models.DecimalField(decimal_places=2, default=1.85, max_digits=5)),
                ('taux_cimr', models.DecimalField(decimal_places=2, default=6.0, max_digits=5)),
                ('taux_frais_prof', models.DecimalField(decimal_places=2, default=20.0, max_digits=5)),
                ('annee', models.IntegerField(unique=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Paramétrage Paie',
                'verbose_name_plural': 'Paramétrages Paie',
                'db_table': 'paie_parametrage',
            },
        ),
        migrations.CreateModel(
            name='PlageHoraire',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100)),
                ('type_plage', models.CharField(choices=[('STANDARD', 'Horaire Standard'), ('FLEXIBLE', 'Horaire Flexible'), ('EQUIPE_MATIN', 'Équipe Matin'), ('EQUIPE_SOIR', 'Équipe Soir'), ('EQUIPE_NUIT', 'Équipe Nuit'), ('TEMPS_PARTIEL', 'Temps Partiel'), ('CADRE', 'Horaire Cadre')], default='STANDARD', max_length=20)),
                ('heure_debut', models.TimeField()),
                ('heure_fin', models.TimeField()),
                ('duree_pause', models.DurationField(default=datetime.timedelta(seconds=3600))),
                ('heure_debut_pause', models.TimeField(blank=True, null=True)),
                ('heure_fin_pause', models.TimeField(blank=True, null=True)),
                ('tolerance_arrivee', models.DurationField(default=datetime.timedelta(seconds=600))),
                ('tolerance_depart', models.DurationField(default=datetime.timedelta(seconds=600))),
                ('jours_travailles', models.JSONField(default=list)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Plage Horaire',
                'verbose_name_plural': 'Plages Horaires',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='RubriquePersonnalisee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=10, unique=True)),
                ('libelle', models.CharField(max_length=100)),
                ('type_rubrique', models.CharField(choices=[('GAIN', 'Gain/Prime'), ('RETENUE', 'Retenue'), ('AVANTAGE', 'Avantage en nature'), ('INDEMNITE', 'Indemnité')], max_length=10)),
                ('mode_calcul', models.CharField(choices=[('FIXE', 'Montant fixe'), ('POURCENTAGE', 'Pourcentage du salaire'), ('FORMULE', 'Formule personnalisée')], max_length=15)),
                ('periodicite', models.CharField(choices=[('MENSUEL', 'Mensuel'), ('UNIQUE', 'Unique'), ('CONDITIONNEL', 'Conditionnel')], max_length=15)),
                ('valeur_fixe', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('pourcentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('formule', models.TextField(blank=True, null=True)),
                ('imposable_ir', models.BooleanField(default=True)),
                ('soumis_cnss', models.BooleanField(default=True)),
                ('soumis_amo', models.BooleanField(default=True)),
                ('soumis_cimr', models.BooleanField(default=False)),
                ('ordre_affichage', models.IntegerField(default=1)),
                ('afficher_bulletin', models.BooleanField(default=True)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Rubrique Personnalisée',
                'verbose_name_plural': 'Rubriques Personnalisées',
                'db_table': 'paie_rubrique_personnalisee',
                'ordering': ['ordre_affichage'],
            },
        ),
        migrations.CreateModel(
            name='Site',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nom du site')),
                ('address', models.CharField(blank=True, max_length=255, null=True, verbose_name='Adresse')),
                ('city', models.CharField(blank=True, max_length=100, null=True, verbose_name='Ville')),
                ('postal_code', models.CharField(blank=True, max_length=10, null=True, verbose_name='Code postal')),
                ('phone', models.CharField(blank=True, max_length=15, null=True, verbose_name='Téléphone')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email')),
                ('website', models.URLField(blank=True, null=True, verbose_name='Site web')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True, verbose_name='Actif')),
            ],
            options={
                'verbose_name': 'Site',
                'verbose_name_plural': 'Sites',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='TypeConge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=20, unique=True)),
                ('libelle', models.CharField(max_length=100)),
                ('categorie', models.CharField(choices=[('LEGAL', 'Congé légal'), ('MALADIE', 'Congé maladie'), ('MATERNITE', 'Congé maternité/paternité'), ('EXCEPTIONNEL', 'Congé exceptionnel'), ('FORMATION', 'Congé formation'), ('SANS_SOLDE', 'Congé sans solde')], max_length=15)),
                ('jours_max_annuel', models.IntegerField(default=0)),
                ('cumul_autorise', models.BooleanField(default=True)),
                ('report_autorise', models.BooleanField(default=True)),
                ('justificatif_requis', models.BooleanField(default=False)),
                ('decompte_weekend', models.BooleanField(default=False)),
                ('remunere', models.BooleanField(default=True)),
                ('taux_remuneration', models.DecimalField(decimal_places=2, default=100.0, max_digits=5)),
                ('jours_acquis_par_mois', models.DecimalField(decimal_places=2, default=0, max_digits=4)),
                ('anciennete_minimum_mois', models.IntegerField(default=0)),
                ('couleur_affichage', models.CharField(default='#007bff', max_length=7)),
                ('ordre_affichage', models.IntegerField(default=1)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Type de Congé',
                'verbose_name_plural': 'Types de Congés',
                'db_table': 'paie_type_conge',
                'ordering': ['ordre_affichage', 'libelle'],
            },
        ),
        migrations.CreateModel(
            name='ValidationPresence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_validation', models.CharField(choices=[('JOURNALIERE', 'Validation Journalière'), ('HEBDOMADAIRE', 'Validation Hebdomadaire'), ('MENSUELLE', 'Validation Mensuelle'), ('PONCTUELLE', 'Validation Ponctuelle')], max_length=15)),
                ('statut', models.CharField(choices=[('EN_ATTENTE', 'En Attente'), ('VALIDEE', 'Validée'), ('REJETEE', 'Rejetée'), ('EN_COURS', 'En Cours de Validation')], default='EN_ATTENTE', max_length=15)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField()),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('commentaire', models.TextField(blank=True)),
                ('documents_joint', models.FileField(blank=True, null=True, upload_to='validations/')),
                ('nb_presences', models.IntegerField(default=0)),
                ('nb_absences', models.IntegerField(default=0)),
                ('nb_retards', models.IntegerField(default=0)),
                ('total_heures_sup', models.DurationField(default=datetime.timedelta(0))),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('cree_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='validations_creees', to=settings.AUTH_USER_MODEL)),
                ('departement', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='paie.department')),
                ('employes', models.ManyToManyField(related_name='validations_presence', to='paie.employee')),
                ('validee_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Validation de Présence',
                'verbose_name_plural': 'Validations de Présence',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='ReglePointage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField()),
                ('tolerance_retard_minutes', models.IntegerField(default=10)),
                ('tolerance_depart_anticipe_minutes', models.IntegerField(default=10)),
                ('seuil_retard_alerte_minutes', models.IntegerField(default=15)),
                ('nb_retards_alerte_mois', models.IntegerField(default=3)),
                ('nb_absences_alerte_mois', models.IntegerField(default=2)),
                ('seuil_heures_sup_jour', models.DurationField(default=datetime.timedelta(seconds=28800))),
                ('seuil_heures_sup_semaine', models.DurationField(default=datetime.timedelta(days=1, seconds=72000))),
                ('taux_majoration_25', models.DecimalField(decimal_places=2, default=25.0, max_digits=5)),
                ('taux_majoration_50', models.DecimalField(decimal_places=2, default=50.0, max_digits=5)),
                ('duree_pause_max_sans_retenue', models.DurationField(default=datetime.timedelta(seconds=3600))),
                ('pause_payee', models.BooleanField(default=False)),
                ('validation_auto_seuil_minutes', models.IntegerField(default=15)),
                ('validation_obligatoire_weekend', models.BooleanField(default=True)),
                ('validation_obligatoire_feries', models.BooleanField(default=True)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('cree_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Règle de Pointage',
                'verbose_name_plural': 'Règles de Pointage',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='RegleConge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=30, unique=True)),
                ('libelle', models.CharField(max_length=150)),
                ('type_regle', models.CharField(choices=[('ACQUISITION', "Règle d'acquisition"), ('VALIDATION', 'Règle de validation'), ('PLANIFICATION', 'Règle de planification'), ('REPORT', 'Règle de report')], max_length=15)),
                ('parametres', models.JSONField(default=dict)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('departements', models.ManyToManyField(blank=True, to='paie.department')),
                ('types_conge', models.ManyToManyField(blank=True, to='paie.typeconge')),
            ],
            options={
                'verbose_name': 'Règle de Congé',
                'verbose_name_plural': 'Règles de Congés',
                'db_table': 'paie_regle_conge',
            },
        ),
        migrations.CreateModel(
            name='PeriodePaie',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('libelle', models.CharField(max_length=100)),
                ('type_periode', models.CharField(choices=[('MENSUEL', 'Mensuel'), ('QUINZAINE', 'Quinzaine'), ('HEBDOMADAIRE', 'Hebdomadaire'), ('JOURNALIER', 'Journalier')], max_length=15)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField()),
                ('date_paie', models.DateField()),
                ('nb_jours_travailles', models.IntegerField(default=30)),
                ('nb_heures_standard', models.DecimalField(decimal_places=2, default=191.33, max_digits=6)),
                ('statut', models.CharField(choices=[('BROUILLON', 'Brouillon'), ('CALCULE', 'Calculée'), ('VALIDEE', 'Validée'), ('CLOTUREE', 'Clôturée')], default='BROUILLON', max_length=10)),
                ('date_calcul', models.DateTimeField(blank=True, null=True)),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('annee_paie', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='periodes', to='paie.anneepaie')),
                ('calcule_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='periodes_calculees', to=settings.AUTH_USER_MODEL)),
                ('parametrage', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='paie.parametragepaie')),
                ('valide_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='periodes_validees', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Période de Paie',
                'verbose_name_plural': 'Périodes de Paie',
                'db_table': 'paie_periode',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='HoraireTravail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('heure_debut_personnalisee', models.TimeField(blank=True, null=True)),
                ('heure_fin_personnalisee', models.TimeField(blank=True, null=True)),
                ('jours_travailles_personnalises', models.JSONField(blank=True, null=True)),
                ('commentaire', models.TextField(blank=True)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('cree_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='horaires', to='paie.employee')),
                ('plage_horaire', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='paie.plagehoraire')),
            ],
            options={
                'verbose_name': 'Horaire de Travail',
                'verbose_name_plural': 'Horaires de Travail',
                'ordering': ['-date_debut'],
                'unique_together': {('employe', 'date_debut')},
            },
        ),
        migrations.AddField(
            model_name='employee',
            name='site',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='paie.site', verbose_name="Site d'affectation"),
        ),
        migrations.CreateModel(
            name='DemandeConge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_demande', models.CharField(blank=True, max_length=20, unique=True)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField()),
                ('date_reprise', models.DateField()),
                ('nb_jours_demandes', models.DecimalField(decimal_places=2, max_digits=5)),
                ('nb_jours_ouvrables', models.DecimalField(decimal_places=2, max_digits=5)),
                ('motif', models.TextField(blank=True, max_length=500)),
                ('priorite', models.CharField(choices=[('NORMALE', 'Normale'), ('URGENTE', 'Urgente'), ('PLANIFIEE', 'Planifiée')], default='NORMALE', max_length=10)),
                ('statut', models.CharField(choices=[('BROUILLON', 'Brouillon'), ('SOUMISE', 'Soumise'), ('EN_ATTENTE_MANAGER', 'En attente Manager'), ('EN_ATTENTE_RH', 'En attente RH'), ('APPROUVEE', 'Approuvée'), ('REFUSEE', 'Refusée'), ('ANNULEE', 'Annulée'), ('EN_COURS', 'En cours'), ('TERMINEE', 'Terminée')], default='BROUILLON', max_length=20)),
                ('justificatif', models.FileField(blank=True, null=True, upload_to='conges/justificatifs/')),
                ('certificat_medical', models.FileField(blank=True, null=True, upload_to='conges/certificats/')),
                ('note_remplacement', models.TextField(blank=True, max_length=300)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('commentaire_interne', models.TextField(blank=True)),
                ('cree_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='demandes_creees', to=settings.AUTH_USER_MODEL)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='demandes_conges', to='paie.employee')),
                ('manager_assigne', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='demandes_a_approuver', to=settings.AUTH_USER_MODEL)),
                ('remplacant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='remplacements', to='paie.employee')),
                ('type_conge', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='paie.typeconge')),
            ],
            options={
                'verbose_name': 'Demande de Congé',
                'verbose_name_plural': 'Demandes de Congés',
                'db_table': 'paie_demande_conge',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='BulletinPaie',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('salaire_base', models.DecimalField(decimal_places=2, max_digits=10)),
                ('heures_supplementaires', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('taux_heure_sup', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('prime_anciennete', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('prime_responsabilite', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('indemnite_transport', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('avantages_nature', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_brut', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_imposable', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_cotisable_cnss', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('cotisation_cnss', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('cotisation_amo', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('cotisation_cimr', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('ir_brut', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('ir_net', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('avances', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('prets', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('autres_retenues', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_retenues', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('net_a_payer', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('charges_cnss_patronal', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('charges_amo_patronal', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('formation_professionnelle', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('prestations_sociales', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('numero_bulletin', models.CharField(max_length=20, unique=True)),
                ('date_generation', models.DateTimeField(auto_now_add=True)),
                ('fichier_pdf', models.FileField(blank=True, null=True, upload_to='bulletins_paie/')),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bulletins', to='paie.employee')),
                ('genere_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('periode', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bulletins', to='paie.periodepaie')),
            ],
            options={
                'verbose_name': 'Bulletin de Paie',
                'verbose_name_plural': 'Bulletins de Paie',
                'db_table': 'paie_bulletin',
                'ordering': ['-periode__date_debut', 'employe__last_name'],
            },
        ),
        migrations.CreateModel(
            name='BaremeIR',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tranche_min', models.DecimalField(decimal_places=2, max_digits=10)),
                ('tranche_max', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux', models.DecimalField(decimal_places=2, max_digits=5)),
                ('somme_a_deduire', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('ordre', models.IntegerField()),
                ('parametrage', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='baremes_ir', to='paie.parametragepaie')),
            ],
            options={
                'verbose_name': 'Barème IR',
                'verbose_name_plural': 'Barèmes IR',
                'db_table': 'paie_bareme_ir',
                'ordering': ['ordre'],
            },
        ),
        migrations.CreateModel(
            name='ApprobationConge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('SOUMISSION', 'Soumission'), ('APPROBATION_MANAGER', 'Approbation Manager'), ('REFUS_MANAGER', 'Refus Manager'), ('APPROBATION_RH', 'Approbation RH'), ('REFUS_RH', 'Refus RH'), ('ANNULATION', 'Annulation'), ('MODIFICATION', 'Modification')], max_length=20)),
                ('role_utilisateur', models.CharField(max_length=20)),
                ('commentaire', models.TextField(blank=True, max_length=500)),
                ('statut_precedent', models.CharField(blank=True, max_length=20)),
                ('statut_nouveau', models.CharField(max_length=20)),
                ('donnees_avant', models.JSONField(blank=True, null=True)),
                ('donnees_apres', models.JSONField(blank=True, null=True)),
                ('date_action', models.DateTimeField(auto_now_add=True)),
                ('adresse_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('demande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='approbations', to='paie.demandeconge')),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Approbation de Congé',
                'verbose_name_plural': 'Approbations de Congés',
                'db_table': 'paie_approbation_conge',
                'ordering': ['-date_action'],
            },
        ),
        migrations.CreateModel(
            name='AlertePresence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_alerte', models.CharField(choices=[('RETARD', 'Retard'), ('ABSENCE', 'Absence Injustifiée'), ('RETARDS_REPETES', 'Retards Répétés'), ('ABSENCES_REPETEES', 'Absences Répétées'), ('OUBLI_POINTAGE', 'Oubli de Pointage'), ('HEURES_SUP_EXCESSIVES', 'Heures Supplémentaires Excessives'), ('PAUSE_PROLONGEE', 'Pause Prolongée'), ('POINTAGE_SUSPECT', 'Pointage Suspect')], max_length=25)),
                ('niveau_gravite', models.CharField(choices=[('INFO', 'Information'), ('ATTENTION', 'Attention'), ('ALERTE', 'Alerte'), ('CRITIQUE', 'Critique')], default='INFO', max_length=15)),
                ('statut', models.CharField(choices=[('NOUVELLE', 'Nouvelle'), ('EN_COURS', 'En Cours de Traitement'), ('RESOLUE', 'Résolue'), ('IGNOREE', 'Ignorée')], default='NOUVELLE', max_length=15)),
                ('date_concernee', models.DateField()),
                ('titre', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('details', models.JSONField(default=dict)),
                ('actions_recommandees', models.TextField(blank=True)),
                ('action_prise', models.TextField(blank=True)),
                ('date_traitement', models.DateTimeField(blank=True, null=True)),
                ('notifiee', models.BooleanField(default=False)),
                ('date_notification', models.DateTimeField(blank=True, null=True)),
                ('destinataires', models.JSONField(default=list)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertes_presence', to='paie.employee')),
                ('traitee_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Alerte de Présence',
                'verbose_name_plural': 'Alertes de Présence',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='SoldeConge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('annee', models.IntegerField()),
                ('jours_acquis', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('jours_pris', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('jours_reportes', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('jours_anticipes', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('ajustement_manuel', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('motif_ajustement', models.TextField(blank=True)),
                ('date_ajustement', models.DateTimeField(blank=True, null=True)),
                ('date_derniere_maj', models.DateTimeField(auto_now=True)),
                ('ajuste_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='soldes_conges', to='paie.employee')),
                ('type_conge', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='paie.typeconge')),
            ],
            options={
                'verbose_name': 'Solde de Congé',
                'verbose_name_plural': 'Soldes de Congés',
                'db_table': 'paie_solde_conge',
                'ordering': ['-annee', 'employe__last_name'],
                'unique_together': {('employe', 'type_conge', 'annee')},
            },
        ),
        migrations.CreateModel(
            name='PresenceJournaliere',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField()),
                ('statut_jour', models.CharField(choices=[('PRESENT', 'Présent'), ('ABSENT', 'Absent'), ('PARTIEL', 'Présence Partielle'), ('CONGE', 'En Congé'), ('MALADIE', 'Arrêt Maladie'), ('MISSION', 'En Mission'), ('TELETRAVAIL', 'Télétravail')], default='ABSENT', max_length=15)),
                ('heure_arrivee', models.DateTimeField(blank=True, null=True)),
                ('heure_sortie', models.DateTimeField(blank=True, null=True)),
                ('pauses', models.JSONField(default=list)),
                ('heures_travaillees', models.DurationField(default=datetime.timedelta(0))),
                ('heures_theoriques', models.DurationField(default=datetime.timedelta(0))),
                ('duree_pauses', models.DurationField(default=datetime.timedelta(0))),
                ('retard_minutes', models.IntegerField(default=0)),
                ('depart_anticipe_minutes', models.IntegerField(default=0)),
                ('heures_supplementaires', models.DurationField(default=datetime.timedelta(0))),
                ('heures_sup_25', models.DurationField(default=datetime.timedelta(0))),
                ('heures_sup_50', models.DurationField(default=datetime.timedelta(0))),
                ('valide', models.BooleanField(default=False)),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('commentaire_rh', models.TextField(blank=True)),
                ('commentaire_employe', models.TextField(blank=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='presences_journalieres', to='paie.employee')),
                ('horaire_travail', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, to='paie.horairetravail')),
                ('valide_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Présence Journalière',
                'verbose_name_plural': 'Présences Journalières',
                'ordering': ['-date'],
                'indexes': [models.Index(fields=['employe', 'date'], name='paie_presen_employe_362433_idx'), models.Index(fields=['date', 'statut_jour'], name='paie_presen_date_5e0f15_idx'), models.Index(fields=['valide'], name='paie_presen_valide_50ee77_idx')],
                'unique_together': {('employe', 'date')},
            },
        ),
        migrations.CreateModel(
            name='Pointage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('type_pointage', models.CharField(choices=[('ARRIVEE', 'Arrivée'), ('SORTIE', 'Sortie'), ('PAUSE_DEBUT', 'Début Pause'), ('PAUSE_FIN', 'Fin Pause')], max_length=15)),
                ('heure_pointage', models.DateTimeField()),
                ('heure_theorique', models.DateTimeField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('NORMAL', 'Normal'), ('RETARD', 'Retard'), ('AVANCE', 'Avancé'), ('CORRIGE', 'Corrigé'), ('SUSPECT', 'Suspect')], default='NORMAL', max_length=10)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('geolocalisation', models.JSONField(blank=True, null=True)),
                ('corrige', models.BooleanField(default=False)),
                ('heure_originale', models.DateTimeField(blank=True, null=True)),
                ('raison_correction', models.TextField(blank=True)),
                ('justifie', models.BooleanField(default=False)),
                ('justification', models.TextField(blank=True)),
                ('document_justificatif', models.FileField(blank=True, null=True, upload_to='pointages/justificatifs/')),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('corrige_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('cree_par', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pointages_crees', to=settings.AUTH_USER_MODEL)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pointages', to='paie.employee')),
            ],
            options={
                'verbose_name': 'Pointage',
                'verbose_name_plural': 'Pointages',
                'ordering': ['-heure_pointage'],
                'indexes': [models.Index(fields=['employe', 'heure_pointage'], name='paie_pointa_employe_ae34d0_idx'), models.Index(fields=['type_pointage', 'heure_pointage'], name='paie_pointa_type_po_8fb891_idx'), models.Index(fields=['statut'], name='paie_pointa_statut_96f087_idx')],
            },
        ),
        migrations.CreateModel(
            name='LigneBulletin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('base_calcul', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('taux_applique', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('montant', models.DecimalField(decimal_places=2, max_digits=10)),
                ('ordre_affichage', models.IntegerField()),
                ('bulletin', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lignes', to='paie.bulletinpaie')),
                ('rubrique', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='paie.rubriquepersonnalisee')),
            ],
            options={
                'db_table': 'paie_ligne_bulletin',
                'ordering': ['ordre_affichage'],
                'unique_together': {('bulletin', 'rubrique')},
            },
        ),
        migrations.AddIndex(
            model_name='demandeconge',
            index=models.Index(fields=['employe', 'statut'], name='paie_demand_employe_80818d_idx'),
        ),
        migrations.AddIndex(
            model_name='demandeconge',
            index=models.Index(fields=['date_debut', 'date_fin'], name='paie_demand_date_de_158d51_idx'),
        ),
        migrations.AddIndex(
            model_name='demandeconge',
            index=models.Index(fields=['statut', 'date_creation'], name='paie_demand_statut_eb53cc_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='bulletinpaie',
            unique_together={('periode', 'employe')},
        ),
        migrations.AddIndex(
            model_name='alertepresence',
            index=models.Index(fields=['employe', 'statut'], name='paie_alerte_employe_26c00a_idx'),
        ),
        migrations.AddIndex(
            model_name='alertepresence',
            index=models.Index(fields=['type_alerte', 'niveau_gravite'], name='paie_alerte_type_al_eada49_idx'),
        ),
        migrations.AddIndex(
            model_name='alertepresence',
            index=models.Index(fields=['date_concernee'], name='paie_alerte_date_co_e3346d_idx'),
        ),
    ]
